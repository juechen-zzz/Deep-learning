

[TOC]

# 多线程并发编程

## 1 线程创建

<img src="../images/image-20210914174331337.png" alt="image-20210914174331337" style="zoom: 50%;" />

### 1.1 Thread

#### 1.1.1 创建方法

1. 新建一个类`TestThread1`继承`Thread`类
2. 重写`run`方法
3. 新建一个`TestThread1`对象，调用`start`方法执行

```java
package thread;

/**
 * @description: Thread创建线程
 * @author: Komorebi
 * @time: 2021/9/22 10:29
 */
public class TestThread1 extends Thread {
    @Override
    public void run() {
        System.out.println("测试Thread方式创建线程");
    }

    public static void main(String[] args) {
        TestThread1 t1 = new TestThread1();
        t1.start();
    }
}
```

#### 1.1.2 start和run的区别

<img src="../images/image-20210922103714231.png" alt="image-20210922103714231" style="zoom: 36%;" />

* `start()`：启动一个新线程，在新的线程运行`run`方法中的代码，只能调用一次
* `run()`：新线程启动后会调用的方法，可以重复调用
* 直接调用 `run `是在主线程中执行了` run`，没有启动新的线程；而使用` start `是启动新的线程，通过新的线程间接执行` run `中的代码

#### 1.1.3 练习：多线程下载图片

> 先下载commons-io包，添加到项目中，右键add as library，否则FileUtils会报错

```java
package thread;

import org.apache.commons.io.FileUtils;

import java.io.File;
import java.io.IOException;
import java.net.URL;

/**
 * @description: 练习Thread实现多线程同步下载图片
 * @author: Komorebi
 * @time: 2021/9/22 10:53
 */
public class TestThread2 extends Thread {
    private String url;
    private String name;

    public TestThread2(String url, String name) {
        this.url = url;
        this.name = name;
    }

    @Override
    public void run() {
        WebDownLoader webDownLoader = new WebDownLoader();
        webDownLoader.downloader(url, name);
        System.out.println("下载的文件名为：" + name);
    }

    public static void main(String[] args) {
        TestThread2 t1 = new TestThread2("http://static.komorebi.top/image-14.jpg", "test1.jpg");
        TestThread2 t2 = new TestThread2("http://static.komorebi.top/image-14.jpg", "test2.jpg");
        TestThread2 t3 = new TestThread2("http://static.komorebi.top/image-14.jpg", "test3.jpg");

        t1.start();
        t2.start();
        t3.start();
    }
}

class WebDownLoader {
    // 下载方法
    public void downloader(String url, String name) {
        try {
            FileUtils.copyURLToFile(new URL(url), new File(name));
        } catch (IOException e) {
            e.printStackTrace();
            System.out.println("IO异常，downloader方法出现问题");
        }
    }
}
```

